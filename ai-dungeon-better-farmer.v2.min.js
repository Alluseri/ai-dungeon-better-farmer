// ==UserScript==
// @name         AI Dungeon Better Farmer
// @namespace    https://www.youtube.com/playlist?list=PLuPCd5VIscosG72QWT03BBZriNDEbryea
// @version      2.0
// @description  Gets rid of the need to spend your precious time to view ads.
// @author       Alluseri
// @match        https://play.aidungeon.io/*
// @icon         https://cdn.discordapp.com/attachments/853155168170147910/1022980412731039855/hibi_transp.ico
// @grant        none
// ==/UserScript==
/* jshint esversion: 11 */
!function(){var e;const t=document.querySelector.bind(document);function n(e,t,n,o){var a=document.createElement(e);for(let e in t||{})a[e]=t[e];var r=o?"Array"==o.constructor.name?o:[o]:[];for(let e in r)a.appendChild(r[e]);return(n||(e=>e))(a)}const o=(e,t)=>(e.style.cssText=t.style.cssText,e);function a(e,t){return{operationName:"EventHookSendUserEvent",variables:{input:{eventName:e,variation:"web",clientInfo:t}},query:"mutation EventHookSendUserEvent($input: EventInput) {\n  sendUserEvent(input: $input)\n}\n"}}async function r(t){return await(await fetch("https://api.aidungeon.io/graphql",{method:"POST",body:JSON.stringify(t),headers:{authorization:e,"content-type":"application/json",accept:"*/*"}})).json()}!function e(){var s=0,i=globalThis.setTimeout;globalThis.setTimeout=function(e,l){if(!document.location.href.includes("/main/adventurePlay"))return(globalThis.setTimeout=i)(e,l);if(e.toString().match(/function\(\){return \w+\(!0\)}/)&&console.log("[AIDBF] Capture: "+ ++s),s>=3){var d=t('[aria-label="Commands list"]');if(!d)return i(e,l);!function c(e){var s=e.firstElementChild,i=s.firstElementChild,l=i.lastElementChild,d=async function(e,n){var o={os:"web",model:navigator.userAgent.toLowerCase(),version:"unknown"},s=a("ad_reward_button_press",o),i=a("ad_rewarded_reward_earned",o),l={operationName:"IncreaseAdCounterAdContext",variables:{},query:"mutation IncreaseAdCounterAdContext($addActions: Int) {\n  increaseAdCountdown(addActions: $addActions)\n}\n"};e.style.backgroundColor="#F64627",e.style.borderColor="#E24C32",n?(r(s),r(i),r(l)):(await r(s),await r(i),await r(l)),e.style.backgroundColor="#43DB7C",e.style.borderColor="#30F178",t('img[src="https://static.aidungeon.io/artwork/actions.png"]').parentElement.parentElement.parentElement.lastElementChild.firstElementChild.innerText=(await r({operationName:"UserContextGetAdCountdown",variables:{},query:"query UserContextGetAdCountdown {\n  adCountdown {\n    id\n    currentCount\n    enforceAds\n    shouldAutoplayAds\n    __typename\n  }\n}\n"})).data.adCountdown.currentCount,e.style.backgroundColor=e.ogBg,e.style.borderColor=e.ogBorder};n("div",{className:s.className},(t=>(t.style.cssText=s.style.cssText,t.ogBg=t.style.backgroundColor="#112244",t.ogBorder=t.style.borderColor="#223355",t.onclick=d.bind(globalThis,t,!1),e.appendChild(t),t)),n("div",{className:i.className},(e=>o(e,i)),n("div",{className:l.className,innerText:"+10 ACTIONS"},(e=>o(e,l))))),n("div",{className:s.className},(t=>(t.style.cssText=s.style.cssText,t.ogBg=t.style.backgroundColor="#113355",t.ogBorder=t.style.borderColor="#224466",t.onclick=d.bind(globalThis,t,!0),e.appendChild(t),t)),n("div",{className:i.className},(e=>o(e,i)),n("div",{className:l.className,innerText:"+10 ACTIONS [FAST]"},(e=>o(e,l)))))}(d),globalThis.setTimeout=i}return i(e,l)}}(),function t(){var n=window.WebSocket.prototype.send;window.WebSocket.prototype.send=function(t){var o=JSON.parse(t);return"connection_init"==o.type&&(e=o.payload.token,window.WebSocket.prototype.send=n),n.apply(this,arguments)}}()}();
